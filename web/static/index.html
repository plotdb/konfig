<!DOCTYPE html><html><head><link rel="stylesheet" type="text/css" href="/assets/lib/bootstrap/main/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/bootstrap.ldui/main/bootstrap.ldui.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldiconfont/main/ldif.min.css"><link rel="stylesheet" type="text/css" href="/css/index.css"><style type="text/css">.config {
  margin: 1em;
  flex: 1 1 200px;
  height: 3em;
}
</style></head><body><div class="w-1024 rwd mx-auto my-4 d-flex align-items-center flex-wrap"><div class="config" ld-each="config"></div></div><div class="w-1024 rwd mx-auto p-3"><div class="rounded shadow-sm border p-4 my-4" id="sample"></div></div><script type="text/javascript" src="/assets/lib/ldcolor/main/ldcolor.min.js"></script><script type="text/javascript" src="/assets/lib/@loadingio/ldquery/main/ldq.min.js"></script><script type="text/javascript" src="/assets/lib/@loadingio/debounce.js/main/debounce.min.js"></script><script type="text/javascript" src="/assets/lib/proxise/main/proxise.min.js"></script><script type="text/javascript" src="/assets/lib/ldview/main/index.min.js"></script><script type="text/javascript" src="/assets/lib/@plotdb/rescope/main/rescope.js"></script><script type="text/javascript" src="/assets/lib/@plotdb/csscope/main/csscope.js"></script><script type="text/javascript" src="/assets/lib/@plotdb/datadom/main/datadom.js"></script><script type="text/javascript" src="/assets/lib/@plotdb/block/main/block.js"></script><script>var config;
config = function(opt){
  var this$ = this;
  opt == null && (opt = {});
  this.root = typeof opt.root === 'string'
    ? document.querySelector(opt.root)
    : opt.root;
  this.evtHandler = {};
  this.cfg = opt.config || {};
  this.value = {};
  this.mgr = new block.manager({
    registry: function(arg$){
      var name, version;
      name = arg$.name, version = arg$.version;
      return "/block/" + name + "/" + version + "/index.html";
    }
  });
  this.init = proxise.once(function(){
    return this$._init();
  });
  this.update = debounce(150, function(){
    return this$._update();
  });
  return this;
};
config.prototype = import$(Object.create(Object.prototype), {
  on: function(n, cb){
    var ref$;
    return ((ref$ = this.evtHandler)[n] || (ref$[n] = [])).push(cb);
  },
  fire: function(n){
    var v, res$, i$, to$, ref$, len$, cb, results$ = [];
    res$ = [];
    for (i$ = 1, to$ = arguments.length; i$ < to$; ++i$) {
      res$.push(arguments[i$]);
    }
    v = res$;
    for (i$ = 0, len$ = (ref$ = this.evtHandler[n] || []).length; i$ < len$; ++i$) {
      cb = ref$[i$];
      results$.push(cb.apply(this, v));
    }
    return results$;
  },
  _init: function(){
    var this$ = this;
    return this.mgr.init().then(function(){
      return this$.view = new ldview({
        root: this$.root,
        handler: {
          config: {
            list: function(){
              var k, ref$, v, results$ = [];
              for (k in ref$ = this$.cfg) {
                v = ref$[k];
                results$.push(v);
              }
              return results$;
            },
            key: function(it){
              return it.name;
            },
            init: function(arg$){
              var node, data;
              node = arg$.node, data = arg$.data;
              return this$._prepare({
                name: data.type,
                root: node,
                data: data
              });
            }
          }
        }
      });
    });
  },
  _update: function(){
    return this.fire('change', this.value);
  },
  _prepare: function(arg$){
    var name, root, data, this$ = this;
    name = arg$.name, root = arg$.root, data = arg$.data;
    return this.mgr.get({
      name: name,
      version: "0.0.1"
    }).then(function(it){
      return it.create({
        data: data
      });
    }).then(function(bi){
      return bi.attach({
        root: root
      }).then(function(){
        return bi['interface']();
      });
    }).then(function(item){
      var v;
      this$.value[data.name] = v = item.get();
      this$.update();
      return item.on('change', function(it){
        this$.value[data.name] = it;
        return this$.update();
      });
    });
  }
});
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}</script><script>(function(it){
  return it.apply({});
})(function(){
  var cfg;
  this.config = {
    palette: {
      name: 'palette',
      type: 'palette'
    },
    number: {
      name: 'number',
      type: 'number',
      range: false,
      min: 10,
      max: 64,
      step: 1
    },
    boolean: {
      name: 'boolean',
      type: 'boolean'
    },
    color: {
      name: 'color',
      type: 'color'
    },
    choice: {
      name: 'choice',
      type: 'choice',
      values: ['left', 'right', 'center'],
      'default': 'left'
    },
    text: {
      name: 'text',
      type: 'text',
      'default': 'default text'
    },
    paragraph: {
      name: 'paragraph',
      type: 'paragraph',
      'default': 'some points\n1. multiple lines. \n2. fit into ui.'
    },
    upload: {
      name: 'upload',
      type: 'upload',
      multiple: true
    },
    font: {
      name: 'font',
      type: 'font'
    }
  };
  console.log(123);
  cfg = new config({
    root: document.body,
    config: this.config
  });
  cfg.on('change', function(it){
    return console.log(it);
  });
  return cfg.init().then(function(){
    return console.log('done.');
  });
});</script></body></html>