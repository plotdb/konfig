<div><script type="@plotdb/block">(function(it){
  return it();
})(function(){
  var blockFactory;
  blockFactory = {
    pkg: {
      extend: {
        name: '@plotdb/konfig.widget.default',
        version: 'master',
        path: 'base'
      },
      dependencies: [
        {
          name: "choosefont.js",
          version: "main",
          path: "choosefont.min.js"
        }, {
          name: "choosefont.js",
          version: "main",
          path: "choosefont.min.css",
          global: true
        }
      ]
    },
    init: function(arg$){
      var root, context, data, pubsub, ldview, ldcover, ChooseFont, obj, view;
      root = arg$.root, context = arg$.context, data = arg$.data, pubsub = arg$.pubsub;
      ldview = context.ldview, ldcover = context.ldcover, ChooseFont = context.ChooseFont;
      obj = {
        font: {}
      };
      pubsub.fire('init', {
        get: function(){
          return obj.font;
        },
        set: function(it){
          return obj.fontview.get('input').value = it || '';
        }
      });
      return view = new ldview({
        root: root,
        init: {
          ldcv: function(arg$){
            var node;
            node = arg$.node;
            return obj.ldcv = new ldCover({
              root: node
            });
          },
          inner: function(arg$){
            var node;
            node = arg$.node;
            obj.cf = new ChooseFont({
              root: node,
              metaUrl: '/assets/lib/choosefont.js/main/fontinfo/meta.json',
              base: 'https://plotdb.github.io/xl-fontset/alpha'
            });
            return obj.cf.init().then(function(){
              return obj.cf.on('choose', function(it){
                return obj.ldcv.set(it);
              });
            });
          }
        },
        action: {
          click: {
            button: function(){
              return obj.ldcv.get().then(function(it){
                if (!it) {
                  return;
                }
                return obj.font = it;
              });
            }
          }
        },
        text: {
          "font-name": function(){
            return obj.font.name || 'Font';
          }
        }
      });
    }
  };
  return blockFactory;
});</script></div>