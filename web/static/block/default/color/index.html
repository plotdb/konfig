<div><script type="@plotdb/block">(function(it){
  return it();
})(function(){
  var blockFactory;
  blockFactory = {
    pkg: {
      extend: {
        name: '@plotdb/konfig.widget.default',
        version: 'master',
        path: 'base'
      },
      dependencies: [
        {
          name: "ldcolor",
          version: "main",
          path: "ldcolor.min.js",
          async: false
        }, {
          name: "@loadingio/ldcolorpicker",
          version: "main",
          path: "ldcp.min.js"
        }, {
          name: "@loadingio/ldcolorpicker",
          version: "main",
          path: "ldcp.min.css",
          global: true
        }
      ]
    },
    init: function(arg$){
      var root, context, pubsub, data, ldview, ldcolor, ldcolorpicker, view, this$ = this;
      root = arg$.root, context = arg$.context, pubsub = arg$.pubsub, data = arg$.data;
      ldview = context.ldview, ldcolor = context.ldcolor, ldcolorpicker = context.ldcolorpicker;
      pubsub.fire('init', {
        get: function(){
          if (this$.ldcp) {
            return ldcolor.web(this$.ldcp.getColor());
          }
        },
        set: function(it){
          return this$.ldcp.set(it);
        }
      });
      this.ldcp = new ldcolorpicker(root, {
        className: "round shadow-sm round flat compact-palette no-button no-empty-color",
        palette: (data['default']
          ? [data['default']]
          : []).concat(data.palette || ['#cc0505', '#f5b70f', '#9bcc31', '#089ccc']),
        context: data.context || 'random'
      });
      view = new ldview({
        ctx: {
          color: ldcolor.web(this.ldcp.getColor())
        },
        root: root,
        handler: {
          color: function(arg$){
            var node, ctx;
            node = arg$.node, ctx = arg$.ctx;
            if (node.nodeName.toLowerCase() === 'input') {
              return node.value = ctx.color;
            } else {
              return node.style.backgroundColor = ctx.color;
            }
          }
        }
      });
      return this.ldcp.on('change', function(it){
        var color;
        color = ldcolor.web(it);
        pubsub.fire('event', 'change', color);
        view.setCtx({
          color: color
        });
        return view.render();
      });
    }
  };
  return blockFactory;
});</script></div>