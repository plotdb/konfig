<div><script type="@plotdb/block">module.exports={pkg:{extend:{name:"@plotdb/konfig",version:"main",path:"base"},dependencies:[{name:"@xlfont/load",version:"main",path:"index.min.js"},{name:"@xlfont/choose",version:"main",path:"index.min.js"},{name:"@xlfont/choose",version:"main",path:"index.min.css",global:true}],i18n:{en:{default:"Default"},"zh-TW":{"system default":"預設字型"}}},init:function(n){var t,e,o,r,i,u,f,l,a,c,s,d,m,h,g,v;t=n.root,e=n.context,o=n.data,r=n.pubsub,i=n.t;u=e.ldview,f=e.ldcover,l=e.xfc;a={font:null,fobj:null};c=function(){if(typeof a._m["default"]==="string"){return{name:a._m["default"]}}else{return a._m["default"]}};s=function(){return Promise.resolve().then(function(){var n;return(n=a.fobj)?n:a.font?g.load(a.font):{}}).then(function(n){a.fobj=n;d();return n})};d=function(){return t.classList.toggle("limited",m())};m=function(){return!!(a.fobj&&a.fobj.limited)};r.fire("init",{get:function(){var n;if(!a.font){return this["default"]()||""}return{name:(n=a.font).name,style:n.style,weight:n.weight}},set:function(n){a.font=!n?n:typeof n==="string"?{name:n}:{name:n.name,style:n.style,weight:n.weight};a.fobj=null;return v.render("font-name")},default:function(){return c()},meta:function(n){return a._meta=n},object:function(n){return g.load(n)["catch"](function(){return null})},limited:function(){return m()}});a._m=o||{};a.font=c();h=l.url?l.url():{};g=new l({root:!t?null:t.querySelector(".ldcv"),initRender:true,meta:h.meta||"https://xlfont.maketext.io/meta",links:h.links||"https://xlfont.maketext.io/links"});r.on("config",function(n){n==null&&(n={});g.config(n);a.fobj=null;return s()});g.init();if(!t){return}g.on("choose",function(n){return a.ldcv.set(n)});return v=new u({root:t,init:{ldcv:function(n){var t;t=n.node;a.ldcv=new f({root:t,inPlace:false});return a.ldcv.on("toggle.on",function(){return debounce(50).then(function(){return g.render()})})}},action:{click:{system:function(n){var t,e;t=n.node;a.font=e=null;a.fobj=null;v.render("font-name");return r.fire("event","change",e)},button:function(n){var t;t=n.node;return a.ldcv.get().then(function(n){if(!n){return}a.font=n?{name:n.name,style:n.style,weight:n.weight}:null;a.fobj=null;v.render("font-name");return r.fire("event","change",a.font)})}}},handler:{"font-name":function(n){var e,t;e=n.node;t=!a.font?i("default"):a.font.name||i("default");if(t.length>10){t=t.substring(0,10)+"..."}e.innerText=t;return s().then(function(n){var t;return e.setAttribute("class",(t=n&&n.className)?t:"")})["catch"](function(){})}}})}};</script></div>
