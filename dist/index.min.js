!function(){var f;function h(t,e){var n,i={}.hasOwnProperty;for(n in e)i.call(e,n)&&(t[n]=e[n]);return t}(f=function(t){var n=this;return this.root="string"==typeof(t=null==t?{}:t).root?document.querySelector(t.root):t.root,this.opt=t,this.evtHandler={},this.useBundle=null==t.useBundle||t.useBundle,this.view=t.view,this.autotab=t.autotab||!1,this._ctrlobj={},this._ctrllist=[],this._tabobj={},this._tablist=[],this._template=null,this._meta=this._clone(t.meta||{}),this._tab=t.tab||{},this._val={},this._obj={},this._objps=[],this.ensureBuilt=proxise(function(){return!0===n.ensureBuilt.running?null:Promise.resolve()}),this.typemap=t.typemap||null,this.mgr=this.mgrChain=new block.manager({registry:function(t){var e=t.name,n=t.version,t=t.path;throw new Error("@plotdb/konfig: "+e+"@"+n+"/"+t+" is not supported")}}),t.manager&&(this.mgr=t.manager,this.mgr.chain(this.mgrChain)),this.init=proxise.once(function(){return n._init()},function(){return n._val}),this._updateDebounced=debounce(150,function(t,e){return n._update(t,e)}),this.doDebounce=!(null!=t.debounce)||t.debounce,this.update=function(t,e){return n.doDebounce?n._updateDebounced(t,e):n._update(t,e)},this}).views={simple:function(){var t=this;return new ldview({root:this.root,initRender:!1,handler:{ctrl:{list:function(){return t._ctrllist.filter(function(t){return!t.meta.hidden})},key:function(t){return t.key},init:function(t){var e=t.node,t=t.data;return e.appendChild(t.root)},handler:function(t){var e=t.node,t=t.data;if(!t.root.parentNode)return e.appendChild(t.root)}}}})},default:function(){var n=this;return new ldview({root:this.root,initRender:!1,handler:{tab:{list:function(){return n._tablist.sort(function(t,e){return e.tab.order-t.tab.order}),n._tablist},key:function(t){return t.key},view:{text:{name:function(t){return t.ctx.tab.id}},handler:{ctrl:{list:function(t){var e=t.ctx;return n._ctrllist.filter(function(t){return t.meta.tab===e.tab.id&&!t.meta.hidden})},key:function(t){return t.key},init:function(t){var e=t.node,t=t.data;return e.appendChild(t.root)},handler:function(t){var e=t.node,t=t.data;return t.root.parentNode||e.appendChild(t.root),t.itf.render()}}}}}}})},recurse:function(){var t,e,n=this;return this._template?t=this._template:((t=ld$.find(this.root,"[ld=template]",0)).parentNode.removeChild(t),t.removeAttribute("ld-scope"),this._template=t),t=t.cloneNode(!0),new ldview(h({ctx:{tab:{id:null}}},h(e={},{template:t,root:this.root,initRender:!1,text:{name:function(t){t=t.ctx;return t.tab?(t.tab.name||"")+"":""}},handler:{tab:{list:function(t){var e=t.ctx,t=n._tablist.filter(function(t){return!(t.tab.parent.tab.id||e.tab.id)||t.tab.parent&&e.tab&&t.tab.parent.tab.id===e.tab.id});return t.sort(function(t,e){return e.tab.order-t.tab.order}),t},key:function(t){return t.key},view:e},ctrl:{list:function(t){var e=t.ctx;return n._ctrllist.filter(function(t){return!!e.tab&&t.meta.tab===e.tab.id&&!t.meta.hidden})},key:function(t){return t.key},init:function(t){var e=t.node,t=t.data;return e.appendChild(t.root)},handler:function(t){var e=t.node,t=t.data;return t.root.parentNode||e.appendChild(t.root),e.style.flex="1 1 "+16*(t.meta.weight||1)+"%",t.itf.render()}}}})))}},f.prototype=h(Object.create(Object.prototype),{on:function(t,e){var n;return((n=this.evtHandler)[t]||(n[t]=[])).push(e)},fire:function(t){for(var e,n,i,r,o=[],a=[],u=1,l=arguments.length;u<l;++u)a.push(arguments[u]);for(e=a,u=0,i=(n=this.evtHandler[t]||[]).length;u<i;++u)r=n[u],o.push(r.apply(this,e));return o},render:function(t){if(null==t&&(t=!1),this.view)return this._view&&!0!==t||("string"==typeof this.view?this._view=this._view||f.views[this.view].apply(this):"function"==typeof this.view?(t={root:this.root,ctrls:this._ctrllist,tabs:this._tablist},this._view=this.view.apply(t,[t])):(this._view=this.view,this._view.ctx({root:this.root,ctrls:this._ctrllist,tabs:this._tablist}))),this._view.render()},_clone:function(t,e){var n,i;if(null==e&&(e={}),Array.isArray(t))return t.slice(0);if("object"!=typeof t)return t;for(n in t)i=t[n],e[n]=this._clone(i);return e},meta:function(t){var e,n,i;return null==t?this._clone(this._meta):(e=t.meta,n=t.tab,i=t.config,this._meta={},this._tab={},null==e||"string"==typeof e.type?(this._meta=this._clone(t),this.build(!0)):(null!=e&&(this._meta=this._clone(e)),null!=n&&(this._tab=n),this.build(!0,i)))},default:function(){var t,l=function(t,e,n,i){var r,o,a,u=[];for(o in null==e&&(e={}),null==n&&(n={}),r=t.child||t)(a=r[o]).type?u.push(e[o]=n[o].itf.default()):a!==r&&u.push(l(a,e[o]||(e[o]={}),n[o]||(n[o]={})));return u};return l(this._meta,t={},this._ctrlobj),t},reset:function(){var t=this.default();return this.set(t),this._update()},limited:function(t){var u,e,l;return null==t&&(t={}),u={any:!1},(l=function(t,e,n){var i,r,o,a=[];for(r in null==e&&(e={}),null==n&&(n={}),i=t.child||t)(o=i[r]).type?(e[r]=null!=n[r].itf.limited&&n[r].itf.limited(),a.push(u.any=u.any||e[r])):o!==i&&a.push(l(o,e[r]||(e[r]={}),n[r]||(n[r]={})));return a})(this._meta,e={},this._ctrlobj),t.detail?e:u.any},get:function(){return JSON.parse(JSON.stringify(this._val))},_objwait:function(t){if(this._objps.push(t),!(this._objps.length<100))return t=this._objps.splice(0),this._objps.push(Promise.all(t))},obj:function(){var t=this;return this.ensureBuilt().then(function(){return Promise.all(t._objps)}).finally(function(){return t._objps.splice(0)}).then(function(){return t._obj})},set:function(t,d){var f,c=this;return null==d&&(d={}),t=JSON.parse(JSON.stringify(t)),this.render(),f=function(t,n,i,e,r,o){var a,u,l,s=[];if(null==n&&(n={}),null==i&&(i={}),null==e&&(e={}),null==r&&(r={}),"object"==typeof(a=t.child||t)){for(u in a)(l=a[u]).type?n[u]===e[u]||d.append&&null==e[u]||(n[u]=e[u],r[u]&&r[u].itf?(r[u].itf.set(n[u],{passive:!0}),n[u]=r[u].itf.get(),s.push(function(e){return c._objwait(Promise.resolve(r[e].itf.object(n[e])).then(function(t){return i[e]=t}))}(u))):s.push(console.warn("@plotdb/konfig: set config `"+u+"` without corresponding ctrl defined in meta."))):s.push("object"==typeof l&&l!==a?f(l,n[u]||(n[u]={}),i[u]||(i[u]={}),e[u]||(e[u]={}),r[u]||(r[u]={}),u):console.warn("@plotdb/konfig: set malformat config under "+u,a));return s}},(d.build?Promise.resolve():this.ensureBuilt()).then(function(){if(d.build||!c.ensureBuilt.running)return f(c._meta,c._val,c._obj,t,c._ctrlobj,null)})},_update:function(t,e){return this.fire("change",JSON.parse(JSON.stringify(this._val)),t,e)},_init:function(){var e=this;return this.mgr.init().then(function(){return e.useBundle&&f.bundle||[]}).then(function(t){return e.mgr.set(t.map(function(t){return new block.class((t.manager=e.mgr,t))}))}).then(function(){return e.build()}).then(function(){return e._val})},_prepareTab:function(t){var e;return this._tabobj[t.id]?((e=this._tabobj[t.id].tab).depth<t.depth&&(e.tab=t),e):(e=document.createElement("div"),this._tablist.push(e={root:e,tab:t,ctrls:[],tabs:[],key:"tabkey-"+this._tablist.length+"-"+Math.random().toString(36).substring(2)}),this._tabobj[t.id]=e)},interface:function(e){var t,n,i,r,o=this,a=e.block?(t=(r={name:(r=e.block).name,version:r.version,path:r.path}).name,n=r.version,r.path):this.typemap&&(a=this.typemap(e.type))?(i=a.ns,t=a.name,n=a.version,a.path):(i=(r=["",e.type,f.version,""])[0],t=r[1],n=r[2],r[3]),u=block.id({ns:i,name:t,version:n,path:a});return(r=(this._lib||(this._lib={}))[u])?Promise.resolve(r):this.mgr.get({ns:i,name:t,version:n,path:a}).then(function(t){return t.create({data:e})}).then(function(t){return t.attach().then(function(){return t.interface()})}).then(function(t){return o._lib[u]=t=null==t?{}:t})},_prepareCtrl:function(i,n,r,o){var t,e,a,u,l,s=this,d=i.id;return o[d]?Promise.resolve():(u=i.block?(e=(t={name:(t=i.block).name,version:t.version,path:t.path}).name,a=t.version,t.path):this.typemap&&(u=this.typemap(i.type))?(l=u.ns,e=u.name,a=u.version,u.path):(l=(t=["",i.type,f.version,""])[0],e=t[1],a=t[2],t[3]),this.mgr.get({ns:l,name:e,version:a,path:u}).then(function(t){return t.create({data:i})}).then(function(t){var e,n=document.createElement("div");return null==i.tab&&(i.tab="default"),e=s._tabobj[i.tab]||s._prepareTab({id:i.tab,name:i.tab,depth:0,parent:{tab:{}}}),s._ctrllist.push(o[d]={block:t,meta:i,root:n,key:"ctrlkey-"+s._ctrllist.length+"-"+Math.random().toString(36).substring(2)}),e.ctrls.push(o[d]),t.attach({root:n,defer:!0}).then(function(){return t.interface()}).then(function(t){return o[d].itf=t})}).then(function(e){var t;return n[d]=t=e.get(),s._objwait(Promise.resolve(e.object(t)).then(function(t){return r[d]=t})),e.on("action",function(t){return s.fire("action",{src:e,data:t})}),e.on("change",function(t){return n[d]=t,s._objwait(Promise.resolve(e.object(t)).then(function(t){return r[d]=t})),s.update(d,t)})}).then(function(){return o[d]}))},build:function(t,e){var n=this;return null==t&&(t=!1),(this.ensureBuilt.running?this.ensureBuilt():Promise.resolve()).then(function(){return n.ensureBuilt.running=!0,Promise.resolve().then(function(){return n._buildTab(t),n._buildCtrl(t).then(function(){return n._ctrllist.map(function(t){return t.block.attach()})}).then(function(){return n.render(t)}).then(function(){if(null!=e)return n.set(e,{build:!0})}).then(function(){n.ensureBuilt.running=!1,n.ensureBuilt.resolve()}).then(function(){return n.update()})})})},_buildCtrl:function(t){var c=this,p=[],m=function(t,e,n,i,r,o){var a,u,l,s,d,f=[];if(null==e&&(e={}),null==n&&(n={}),null==i&&(i={}),t&&"object"==typeof t&&(a=t.child||t,(!(u=t.child?t.tab:null)&&c.autotab||u)&&r&&(u=u||"tabid-"+c._tablist.length+"-"+Math.random().toString(36).substring(2),(l=c._tabobj[u]||c._prepareTab(h({id:u,name:r,depth:o?o.tab.depth+1:0,order:t.child&&null!=t.order?t.order:void 0,parent:o||{tab:{}}},"undefined"!=typeof _tab&&null!==_tab&&_tab?_tab:{}))).tab.parent||(l.tab.parent=o||{tab:{}}),l.tab.parent!==o||function(t,e){var n=-1,i=e.length>>>0;for(;++n<i;)if(t===e[n])return 1;return}(l,o.tabs)||o.tabs.push(l)),a)){for(s in a)(d=a[s]).type?(h((d.id=s,d),u&&!d.tab?{tab:u}:{}),p.push(c._prepareCtrl(d,e,n,i))):f.push(m(d,e[s]||(e[s]={}),n[s]||(n[s]={}),i[s]||(i[s]={}),s,l));return f}};return(t=null==t?!1:t)&&this._ctrllist&&this._ctrllist.map(function(t){var e=t.block,t=t.root;if(e.destroy&&e.destroy(),t.parentNode)return t.parentNode.removeChild(t)}),Promise.all((this._ctrllist||[]).map(function(t){return t.block.detach()})).then(function(){return!t&&c._val||(c._val={},c._obj={}),!t&&c._ctrlobj||(c._ctrlobj={}),!t&&c._ctrllist||(c._ctrllist=[]),m(c._meta,c._val,c._obj,c._ctrlobj,null),Promise.all(p)})},_buildTab:function(t){var f,c=this;if(null==t&&(t=!1),"ctrl"!==this.renderMode)return t&&this._tablist&&this._tablist.map(function(t){t=t.root;if(t.parentNode)return t.parentNode.removeChild(t)}),!t&&this._tablist||(this._tablist=[]),this._tab||(this._tab={}),t&&(this._tabobj={}),(f=function(n,t,e){var i,r,o,a,u,l,s,d=[];if(null==t&&(t=0),null==e&&(e={tab:{}}),n&&(Array.isArray(n)||"object"==typeof n)){for(a=0,u=(i=Array.isArray(n)?n:function(){var t,e=[];for(r in t=n)o=t[r],e.push({id:r,v:o});return e}().map(function(t,e){var n=t.id,t=t.v;return t.id=n,t})).length;a<u;++a)h(((l=i[s=a]).depth=t,l.parent=e,l),l.name?{}:{name:l.id}),h(l,null==l.order?{order:s}:{}),s=c._prepareTab(l),d.push(f(l.child,(l.depth||0)+1,s));return d}})(JSON.parse(JSON.stringify(this._tab)))}}),f.merge=function(t){var e,n,i,r,a,o;for(null==t&&(t={}),n=[],i=1,r=arguments.length;i<r;++i)n.push(arguments[i]);for(a=function(t,e){var n,i,r,o=(n=[(t=null==t?{}:t).child||t,(e=null==e?{}:e).child||e])[0];for(r in i=n[1])i[r].type||o[r]&&o[r].type?o[r]?o[r]&&h(o[r],e[r]):o[r]=e[r]:"object"==typeof i[r]&&(o[r]=a(o[r],i[r]));return t},i=0,r=(e=n).length;i<r;++i)o=i,t=a(t,JSON.parse(JSON.stringify(e[o])));return t},f.append=function(){for(var t,o,e,n,i=[],r=0,a=arguments.length;r<a;++r)i.push(arguments[r]);for(o=function(t,e){var n,i,r=[];for(n in e)"object"==typeof(i=e[n])&&(t[n],o(t[n],i)),r.push(t[n]=i);return r},r=(t=i).length-2;0<=r;--r)e=r,e=[JSON.parse(JSON.stringify(t[e])),t[e+1]],o(n=e[0],e[1]);return n},f.version="main","undefined"!=typeof module&&null!==module?module.exports=f:"undefined"!=typeof window&&null!==window&&(window.konfig=f),f.bundle=(f.bundle||[]).concat([{name:"@plotdb/konfig",version:"main",path:"base",code:'<div><div class="d-flex align-items-center"><div class="flex-grow-1 d-flex align-items-center"><div ld="name"></div><div ld="hint">?</div></div><plug name="ctrl"></plug></div><plug name="config"></plug><style type="text/css">[ld=hint]{margin-left:.5em;width:1.2em;height:1.2em;border-radius:50%;background:rgba(0,0,0,0.1);font-size:10px;line-height:1.1em;text-align:center;cursor:pointer}</style><script type="@plotdb/block">module.exports={pkg:{dependencies:[{name:"@loadingio/vscroll",version:"main",path:"index.min.js"},{name:"@loadingio/debounce.js",version:"main",path:"index.min.js"},{name:"ldview",version:"main",path:"index.min.js"},{name:"ldcover",version:"main",path:"index.min.js"},{name:"ldcover",version:"main",path:"index.min.css"},{name:"ldloader",version:"main",path:"index.min.js"},{name:"ldloader",version:"main",path:"index.min.css",global:true},{name:"zmgr",version:"main",path:"index.min.js"}]},init:function(n){var e,t,i,r,a,o,u,m,d,l,s=this;e=n.root,t=n.context,i=n.data,r=n.pubsub,a=n.t;this._meta=i;o=t.ldcover,u=t.ldloader,m=t.zmgr;d=new m;o.zmgr(d);u.zmgr(d);r.on("init",function(n){var e;n==null&&(n={});s.itf=e={evtHandler:{},get:n.get||function(){},set:n.set||function(){},meta:n.meta||function(n){return s._meta=n},limited:n.limited||null,default:n["default"]||function(){return(s._meta||{})["default"]},object:n.object||function(n){return Promise.resolve(n)},render:function(){l.render();if(n.render){return n.render()}},on:function(n,t){var i=this;return(Array.isArray(n)?n:[n]).map(function(n){var e;return((e=i.evtHandler)[n]||(e[n]=[])).push(t)})},fire:function(n){var e,t,i,r,a,o,u,m=[];t=[];for(i=1,r=arguments.length;i<r;++i){t.push(arguments[i])}e=t;for(i=0,o=(a=this.evtHandler[n]||[]).length;i<o;++i){u=a[i];m.push(u.apply(this,e))}return m},action:n.action||{}};if(l){return l.render("hint")}});r.on("event",function(n){var e,t,i,r;t=[];for(i=1,r=arguments.length;i<r;++i){t.push(arguments[i])}e=t;return s.itf.fire.apply(s.itf,[n].concat(e))});if(!e){return}return l=new ldview({root:e,text:{name:function(){return a(s._meta.name||s._meta.id||"")}},handler:{hint:function(n){var e;e=n.node;return e.classList.toggle("d-none",!s._meta.hint)}},action:{click:{hint:function(){return alert(a(s._meta.hint||"no hint"))}}}})},interface:function(){return this.itf}};<\/script></div>'},{name:"@plotdb/konfig",version:"main",path:"boolean",code:'<div><script type="@plotdb/block">module.exports={pkg:{extend:{name:"@plotdb/konfig",version:"main",path:"base"},dependencies:[{name:"ldview",version:"main",path:"index.min.js"}]},init:function(t){var e,n,a,i,r,s,u,f,o=this;e=t.root,n=t.context,a=t.pubsub,i=t.data;r=n.ldview;s={default:false,state:undefined};u=function(t){t==null&&(t={});o._meta=JSON.parse(JSON.stringify(t));return s["default"]=o._meta["default"],s.state=s.state!=null?s.state:o._meta["default"]||false,s};u(i);a.fire("init",{get:function(){return s.state},set:function(t,e){var n;e==null&&(e={});n=s.state!==t&&!e.passive;s.state=!!t;if(n){a.fire("event","change",s.state)}return f.render("switch")},default:function(){return s["default"]},meta:function(t){return u(t)}});return f=new r({root:e,action:{click:{switch:function(){s.state=!s.state;f.render("switch");return a.fire("event","change",s.state)}}},handler:{switch:function(t){var e;e=t.node;return e.classList.toggle("on",s.state)}}})}};<\/script></div>'},{name:"@plotdb/konfig",version:"main",path:"button",code:'<div><script type="@plotdb/block">module.exports={pkg:{extend:{name:"@plotdb/konfig",version:"main",path:"base"},dependencies:[],i18n:{"zh-TW":{config:"設定"}}},init:function(t){var n,e,a,u,r,i,o,d,f,c;n=t.root,e=t.context,a=t.data,u=t.pubsub,r=t.t;i=e.ldview,o=e.ldcolor;d={data:a["default"],default:a["default"]};f=function(){return u.fire("event","change",d.data)};u.fire("init",{get:function(){return d.data},set:function(t,n){var e;n==null&&(n={});e=d.data!==t&&!n.passive;d.data=t;if(e){return f()}},default:function(){return d["default"]},meta:function(t){return d.data=d["default"]=t["default"]}});return c=new i({root:n,action:{click:{button:function(){return Promise.resolve(a.cb(d.data)).then(function(t){if(d.data===t){return}d.data=t;return f()})}}},text:{button:function(){return a.text||"..."}}})}};<\/script></div>'},{name:"@plotdb/konfig",version:"main",path:"choice",code:'<div><script type="@plotdb/block">module.exports={pkg:{extend:{name:"@plotdb/konfig",version:"main",path:"base"},dependencies:[]},init:function(e){var t,n,i,r,a,u,l,o,f,c=this;t=e.root,n=e.context,i=e.data,r=e.pubsub;this._meta={};a=n.ldview;u=function(){var e;e=l();return t.classList.toggle("limited",e)};l=function(){if(c._meta.disableLimit){return false}if(c._meta.limit==null||c._meta.limit===false){return false}return typeof f!="undefined"&&f!==null?!in$(f.get("select").value,c._meta.limit):false};o=function(e){c._meta=JSON.parse(JSON.stringify(e));return u()};o(i);r.fire("init",{get:function(){return f.get("select").value},set:function(e,t){var n;t==null&&(t={});n=f.get("select").value!==e&&!t.passive;f.get("select").value=e;if(n){r.fire("event","change",e)}return u()},default:function(){return c._meta["default"]},meta:function(e){return o(e)},limited:function(){return l()}});f=new a({root:t,action:{change:{select:function(e){var t;t=e.node;u();return r.fire("event","change",t.value)}}},handler:{select:function(e){var t;t=e.node;return t.setAttribute("aria-label",c._meta.name||"generic")},option:{list:function(){return c._meta.values},key:function(e){return e},init:function(e){var t,n,i;t=e.node,n=e.data;i=typeof n==="object"?n.value:n;if(c._meta["default"]===i){return t.setAttribute("selected","selected")}},handler:function(e){var t,n,i,r,a;t=e.node,n=e.data;i=typeof n==="object"?n:{value:n,name:n},r=i.value,a=i.name;t.setAttribute("value",r);return t.textContent=a}}}});return f.init().then(function(){return u()})}};function in$(e,t){var n=-1,i=t.length>>>0;while(++n<i)if(e===t[n])return true;return false}<\/script></div>'},{name:"@plotdb/konfig",version:"main",path:"color",code:'<div><script type="@plotdb/block">module.exports={pkg:{extend:{name:"@plotdb/konfig",version:"main",path:"base"},dependencies:[{name:"ldcolor",version:"main",path:"index.min.js",async:false},{name:"@loadingio/ldcolorpicker",version:"main",path:"index.min.js"},{name:"@loadingio/ldcolorpicker",version:"main",path:"index.min.css",global:true}]},init:function(e){var t,r,n,o,i,c,l,a,u,s,d,f=this;t=e.root,r=e.context,n=e.pubsub,o=e.data;i=r.ldview,c=r.ldcolor,l=r.ldcolorpicker;this._meta=o;this.render=function(){n.fire("render");if(typeof d!="undefined"&&d!==null){return d.render()}};a=function(){return n.fire("event","change",f.c)};this.set=function(e){this.c=e;if(!(e==="currentColor"||e==="transparent"||isNaN(c.hsl(e).h))){this.ldcp.setColor(e)}return this.render()};this.prepareDefault=function(e){var t;e==null&&(e={});this["default"]=(t=e["default"])==="currentColor"||t==="transparent"?e["default"]:c.web(e["default"]||this.ldcp.getColor());if(e.overwrite){return this.set(this["default"])}};u=function(e){var t,r,n;e==null&&(e={});t=e.palette||["#cc0505","#f5b70f","#9bcc31","#089ccc"];if(Array.isArray(t)){t={colors:t}}t.colors=t.colors.map(function(e){return c.web(e)});if(e["default"]){r=c.web(e["default"]);if(!in$(r,t.colors.concat(["transparent","currentColor"]))){t.colors=[r].concat(t.colors)}}else{r=t.colors[e.idx||0]||e.colors[0]}if(!~(n=t.colors.indexOf(r))){n=0}return{palette:t,default:r,idx:n}};n.fire("init",{get:function(){return f.c},set:function(e,t){var r;t==null&&(t={});r=!c.same(e,f.c)&&!t.passive;f.set(e);if(r){return a()}},default:function(){return f["default"]},meta:function(e){var t;f._meta=e;t=u(e);f.ldcp.setPalette(t.palette);if(t.idx!=null){f.ldcp.setIdx(t.idx)}return f.prepareDefault({overwrite:true,default:t["default"]})}});s=u(o);this.ldcp=new l(t.querySelector("[ld~=input]"),{className:"round shadow-sm round flat compact-palette no-empty-color vertical",palette:s.palette,idx:s.idx,context:o.context||"random",exclusive:o.exclusive!=null?o.exclusive:true});this.prepareDefault({overwrite:true,default:s["default"]});d=new i({root:t,action:{keyup:{input:function(e){var t,r,n;t=e.node,r=e.ctx,n=e.evt;if(n.keyCode===13){f.ldcp.setColor(t.value);return f.c=t.value}}},click:{default:function(e){var t,r;t=e.node,r=e.ctx;f.c="currentColor";n.fire("event","change",f.c);return f.render()}}},handler:{preset:{list:function(){return f._meta.presets||[]},key:function(e){return e},view:{text:{"@":function(e){var t;t=e.ctx;return t}},action:{click:{"@":function(e){var t;t=e.ctx;f.c=t;n.fire("event","change",f.c);return f.render()}}}}},color:function(e){var t,r,n;t=e.node,r=e.ctx;n=c.web(f.c);if(t.nodeName.toLowerCase()==="input"){return t.value=isNaN(c.hsl(f.c).h)?f.c:n}else{return t.style.backgroundColor=n}}}});return this.ldcp.on("change",function(e){f.c=c.web(e);a();return f.render()})}};function in$(e,t){var r=-1,n=t.length>>>0;while(++r<n)if(e===t[r])return true;return false}<\/script></div>'},{name:"@plotdb/konfig",version:"main",path:"font",code:'<div><script type="@plotdb/block">var singleton;singleton={digest:{}};module.exports={pkg:{syncInit:true,extend:{name:"@plotdb/konfig",version:"main",path:"base"},dependencies:[{name:"@xlfont/load",version:"main",path:"index.min.js"},{name:"@xlfont/choose",version:"main",path:"index.min.js"},{name:"@xlfont/choose",version:"main",path:"index.min.css",global:true}],i18n:{en:{default:"Default"},"zh-TW":{"system default":"預設字型"}}},destroy:function(){return this._obj.ldcv.destroy({removeNode:true})},init:function(n){var e,t,i,o,r,f,l,u,a,d,s,c,m,g,h,v,b,y,p;e=n.root,t=n.context,i=n.data,o=n.pubsub,r=n.t;f=t.ldview,l=t.ldcover,u=t.xfc;a=i.dataSource||{};this._obj=d={font:null,fobj:null,digest:singleton.digest};s=function(){return typeof d._m["default"]==="string"?{name:d._m["default"]}:d._m["default"]||{}};c=function(n){var t,e,i;n==null&&(n={});t=n.font;e=n.cancelable;if(!t){t=d.font||(d.font=s())}i=(t.mod||(t.mod={})).file||{};return Promise.resolve().then(function(){return i.blob instanceof Blob?i.blob:d.digest[i.digest]?d.digest[i.digest].blob:null}).then(function(n){if(n||!i.digest){return n}else if(a.getBlob){return a.getBlob(i)}else{return n}}).then(function(n){i.blob=n;if(!(n&&a.digest)){return}return a.digest(i).then(function(n){var e;if(i.digest!==n){d.changed=true}i.digest=n;return import$((e=t.mod||(t.mod={})).file||(e.file={}),i)})}).then(function(){return b.load(t)["catch"](function(){return b.load(s())})["catch"](function(){return null})}).then(function(n){if(d.font!==t&&e){return lderror.reject(999)}if(d.font===t){d.fobj=n;m()}return n||{}})};m=function(){return e.classList.toggle("limited",g())};g=function(){var n;return!!(d.fobj&&((n=d.fobj).mod||(n.mod={})).limited)};h=function(n){var e,t,i;n==null&&(n={});e=n.mod||{};t={name:n.name,style:n.style,weight:n.weight};if(e.limited){(t.mod||(t.mod={})).limited=e.limited}if(e.file&&(e.file.blob||e.file.key||e.file.digest)){(t.mod||(t.mod={})).file={key:(i=e.file).key,digest:i.digest,name:i.name,lastModified:i.lastModified,size:i.size,type:i.type}}return t};o.fire("init",{get:function(){return!d.font?this["default"]()||"":h(d.font)},set:function(n,e){var t,i;e==null&&(e={});t=!n?n:typeof n==="string"?{name:n}:h(n);i=JSON.stringify(d.font||{})!==JSON.stringify(t||{})&&!e.passive;d.font=t;d.fobj=null;if(i){o.fire("event","change",d.font)}return d.view.render("font-name")},default:function(){return s()},meta:function(n){return d._meta=n},object:function(n){n==null&&(n={});return c({font:n})},limited:function(){return g()}});d._m=i||{};d.font=s();v=u.url?u.url():{};b=new u({root:!e?null:e.querySelector(".ldcv"),initRender:false,meta:v.meta||"https://xlfont.maketext.io/meta",links:v.links||"https://xlfont.maketext.io/links"});o.on("config",function(n){n==null&&(n={});b.config(n);d.fobj=null;return c()});if(!e){return}b.on("choose",function(n){return d.ldcv.set(n)});y=e.querySelector("[ld=ldcv]");d.view=p=new f({root:e,init:{ldcv:function(n){var e;e=n.node;d.ldcv=new l({root:e,inPlace:false});return d.ldcv.on("toggle.on",function(){return debounce(50).then(function(){return b.render()})})}},action:{click:{system:function(n){var e,t;e=n.node;d.font=t=null;d.fobj=null;p.render("font-name");return o.fire("event","change",t)},button:function(n){var e;e=n.node;return d.ldcv.get().then(function(e){var t;if(!e){return{font:e}}t=(e.mod||{}).file;if(!(t&&t.blob&&a.digest)){return{font:e}}return a.digest(t).then(function(n){t.digest=n;d.digest[n]=t;if(a.getKey==null){return{font:e,file:t}}return a.getKey(t).then(function(n){t.key=n;return{font:e,file:t}})})}).then(function(n){var e,t,i;e=n.font,t=n.file;if(!e){return}d.font={name:e.name,style:e.style,weight:e.weight};((i=d.font).mod||(i.mod={})).file=t;d.fobj=null;p.render("font-name");return o.fire("event","change",d.font)})}}},handler:{"font-name":function(n){var t,e;t=n.node;e=!d.font?r("default"):d.font.name||r("default");if(e.length>10){e=e.substring(0,10)+"..."}t.innerText=e;return c({cancelable:true}).then(function(n){var e;t.setAttribute("class",(e=n&&n.className)?e:"");return t.setAttribute("title",n?n.name||"unnamed":"unnamed")})["catch"](function(n){if(lderror.id(n)===999){}})}}});return this.chooser=function(){return b},this.cover=function(){return d.ldcv},this.dom={cover:y},this.metadata=function(n){return b.metadata(n)},this}};function import$(n,e){var t={}.hasOwnProperty;for(var i in e)if(t.call(e,i))n[i]=e[i];return n}<\/script></div>'},{name:"@plotdb/konfig",version:"main",path:"multiline",code:'<div><script type="@plotdb/block">module.exports={pkg:{extend:{name:"@plotdb/konfig",version:"main",path:"base"},dependencies:[]},init:function(t){var e,n,i,c,v,r,a,u,p;e=t.root,n=t.context,i=t.data,c=t.pubsub;v={default:i["default"]||"",data:i["default"]||""};r=n.ldview,a=n.ldcover;c.fire("init",{get:function(){return v.data||""},set:function(t,e){var n;e==null&&(e={});n=v.data!==(t||"")&&!e.passive;v.data=t||"";if(n){c.fire("event","change",v.data)}return p.render()},default:function(){return v["default"]},meta:function(t){return v["default"]=t["default"]}});u=function(t){var e,n;e=t.node;n=e.value;if(v.data!==n){c.fire("event","change",n)}v.data=n;return p.render()};return p=new r({root:e,init:{ldcv:function(t){var e;e=t.node;v.ldcv=new a({root:e,resident:false,inPlace:false});return v.ldcv.on("toggled.on",function(){return p.get("textarea").focus()})}},handler:{panel:function(t){var e;e=t.node},input:function(t){var e,n,i;e=t.node;e.value=v.data||"";e.textContent=(v.data||"").substring(0,10)+" ...";n=e.getAttribute("data-mode");return e.classList.toggle("d-none",!(i=n==="multiline")!==!v.multiline&&(i||v.multiline))},textarea:function(t){var e;e=t.node;return e.value=v.data||""},multiline:function(t){var e;e=t.node;return e.classList.toggle("active",!!v.multiline)}},action:{input:{input:u},change:{input:u},click:{multiline:function(t){var e;e=t.node;v.multiline=!v.multiline;return p.render("multiline","input")},input:function(t){var e,n,i,r,a,u,l,o,d,f;e=t.node;if(!v.multiline){return}n=p.getAll("input").map(function(t){return t.getBoundingClientRect()}).filter(function(t){return t.width})[0];i=p.get("panel").getBoundingClientRect();r=(a=window.innerWidth-(n.left+n.width))<(u=n.width/2)?a:u;l=(a=n.left)<(u=n.width/2)?a:u;o=n.left-l;d=n.width+r+l;f=n.top+(window.scrollTop||0);import$(p.get("ldcv").style,{left:o+"px",top:f+"px"});import$(p.get("panel").style,{width:d+"px"});return v.ldcv.get().then(function(t){var e;if(t!=="ok"){return}e=p.get("textarea").value;if(v.data!==e){c.fire("event","change",e)}v.data=e;return p.render()})}}}})}};function import$(t,e){var n={}.hasOwnProperty;for(var i in e)if(n.call(e,i))t[i]=e[i];return t}<\/script></div>'},{name:"@plotdb/konfig",version:"main",path:"note",code:'<div><script type="@plotdb/block">module.exports={pkg:{extend:{name:"@plotdb/konfig",version:"main",path:"base"},dependencies:[{name:"marked",version:"main",path:"marked.min.js"},{name:"dompurify",version:"main",path:"dist/purify.min.js"}]},init:function(e){var n,t,r,i,a,o,u,d,s,m,f,l=this;n=e.root,t=e.context,r=e.data,i=e.pubsub;a=t.ldview,o=t.marked,u=t.DOMPurify;d=new o.Renderer;d.link=function(e,n,t){var r;r=o.Renderer.prototype.link.call(this,e,n,t);return r.replace("<a",\'<a target="_blank" rel="noopener noreferrer" \')};o.setOptions({renderer:d});s={};this._meta={};m=function(e){return l._meta=JSON.parse(JSON.stringify(e))};i.fire("init",{get:function(){return""},set:function(e,n){n==null&&(n={});return""},default:function(){return""},meta:function(e){return m(e)},limited:function(){return false},render:function(){}});m(r);return f=new a({root:n,handler:{text:function(e){var n;n=e.node;if(l._meta.markdown!=null&&!l._meta.markdown){return n.textContent=l._meta.desc||""}else{return n.innerHTML=u.sanitize(o.parse(l._meta.desc||""))}}}})}};<\/script></div>'},{name:"@plotdb/konfig",version:"main",path:"number",code:'<div><script type="@plotdb/block">module.exports={pkg:{extend:{name:"@plotdb/konfig",version:"main",path:"base"},dependencies:[{name:"ldslider",version:"main",path:"index.min.css"},{name:"ldslider",version:"main",path:"index.min.js"}]},init:function(t){var e,n,i,r,l,a,u,o,f,d,s,m,c,p=this;e=t.root,n=t.context,i=t.data,r=t.pubsub;l=n.ldview,a=n.ldslider;u={};this._meta={};o=function(){var t;if(!u.ldrs){return}t=Object.fromEntries(["min","max","step","from","to","exp","limitMin","limitMax","range","label"].map(function(t){return[t,p._meta[t]]}).filter(function(t){return t[1]!=null}));if(!s()){delete t.limitMin;delete t.limitMax}return u.ldrs.setConfig(t)};f=function(t){if(t.from!=null){console.warn("[@plotdb/konfig] ctrl should use `default` for default value.\\nplease update your config to comply with it.")}if(t["default"]!=null){if(typeof t["default"]==="object"){import$(t,t["default"])}else if(typeof t["default"]==="number"){t.from=t["default"]}}p._meta=JSON.parse(JSON.stringify(t));return o()};d=function(){return e.classList.toggle("limited",m())};s=function(){return!p._meta.disableLimit&&!!(p._meta.limitMax!=null||p._meta.limitMin!=null)};m=function(){var t;if(!s()){return false}t=u.ldrs.get();return p._meta.limitMax!=null&&t>p._meta.limitMax||p._meta.limitMin!=null&&t<=p._meta.limitMin};r.fire("init",{get:function(){return u.ldrs.get()},set:function(t,e){var n;e==null&&(e={});n=u.ldrs.get()!==t&&!e.passive;u.ldrs.set(t);if(n){r.fire("event","change",t)}return d()},default:function(){return p._meta["default"]},meta:function(t){return f(t)},limited:function(){return m()},render:function(){return u.ldrs.update()}});f(i);return c=new l({root:e,action:{click:{switch:function(){return u.ldrs.edit()}}},init:{ldrs:function(t){var e;e=t.node;u.root=e;u.ldrs=new a({root:e});o();u.ldrs.on("change",function(t){d();return r.fire("event","change",t)});return d()}}})}};function import$(t,e){var n={}.hasOwnProperty;for(var i in e)if(n.call(e,i))t[i]=e[i];return t}<\/script></div>'},{name:"@plotdb/konfig",version:"main",path:"palette",code:'<div><script type="@plotdb/block">module.exports={pkg:{extend:{name:"@plotdb/konfig",version:"main",path:"base"},dependencies:[{name:"ldbutton",version:"main",path:"index.min.css",global:true},{name:"ldcolor",version:"main",path:"index.min.js",async:false},{name:"ldslider",version:"main",path:"index.min.js",async:false},{name:"ldslider",version:"main",path:"index.min.css",global:true},{name:"@loadingio/ldcolorpicker",version:"main",path:"index.min.js",async:false},{name:"@loadingio/ldcolorpicker",version:"main",path:"index.min.css"},{name:"@loadingio/vscroll",version:"main",path:"index.min.js"},{name:"ldpalettepicker",version:"main",path:"index.min.css",global:true},{name:"ldpalettepicker",version:"main",path:"index.min.js"}]},init:function(e){var n,t,i,r,a,l,o,s,p,d,u,c,f,m=this;n=e.root,t=e.context,i=e.pubsub,r=e.data,a=e.i18n,l=e.manager;o=t.ldview,s=t.ldcolor,p=t.ldpp,d=t.ldcover;u={};c=function(e){e==null&&(e={});m._meta=JSON.parse(JSON.stringify(e));return u["default"]=m._meta["default"]||p.defaultPalette,u.pal=u.pal||m._meta["default"]||p.defaultPalette,u};c(r);i.fire("init",{get:function(){return u.pal},set:function(e,n){var t;n==null&&(n={});t=JSON.stringify(u.pal||{})!==JSON.stringify(e||{})&&!n.passive;u.pal=e;if(t){i.fire("event","change",u.pal)}return f.render()},default:function(){return u["default"]},meta:function(e){return c(e)}});n=ld$.find(n,"[plug=config]",0);f=new o({root:n,action:{click:{ldp:function(e){var n,t;n=e.node;t=n.getAttribute("data-action")||"edit";return Promise.resolve().then(function(){var e,n;if(u.initing){return u.initing()}if(u.ldpp){return}u.initing=proxise(function(){});e=Array.isArray(r.palettes)?r.palettes:typeof r.palettes==="string"?p.get(r.palettes):null;n=e?Promise.resolve(e):l.rescope.load([{name:"ldpalettepicker",version:"main",path:"index.min.js",async:false},{name:"ldpalettepicker",version:"main",path:"all.palettes.js"}]).then(function(e){var n;n=e.ldpp;return n.get("all")});return n.then(function(e){u.ldpp=new p({root:f.get("ldcv"),ldcv:{inPlace:false},useClusterizejs:true,i18n:a,palette:r.palette,palettes:e,useVscroll:true});if(!u.initing){return}u.initing.resolve();return u.initing=false})}).then(function(){u.ldpp.edit(u.pal,false);if(t==="edit"){u.ldpp.tab("edit")}else{u.ldpp.tab("view")}return u.ldpp.get()}).then(function(e){if(!e){return}u.pal=e;f.render("color");return i.fire("event","change",u.pal)})}}},handler:{color:{list:function(){var e;return((e=u.pal||(u.pal={})).colors||(e.colors=[])).map(function(e,n){return import$({_idx:n},s.hsl(e))})},key:function(e){return e._idx},handler:function(e){var n,t;n=e.node,t=e.data;return n.style.backgroundColor=s.web(t)}}}});return f.render()}};function import$(e,n){var t={}.hasOwnProperty;for(var i in n)if(t.call(n,i))e[i]=n[i];return e}<\/script></div>'},{name:"@plotdb/konfig",version:"main",path:"popup",code:'<div><script type="@plotdb/block">module.exports={pkg:{extend:{name:"@plotdb/konfig",version:"main",path:"base"},dependencies:[],i18n:{"zh-TW":{config:"設定"}}},init:function(t){var n,e,r,i,o,u,a,f,p,c,d;n=t.root,e=t.context,r=t.data,i=t.pubsub,o=t.t;u={};a=function(t){var n;if(!t){return null}else if(n=t.data){return n}else{return t}};f=function(t){var n;u.text=(n=t&&t.text)?n:typeof t==="string"?t+"":o("config");return d.render("button")};p=e.ldview,c=e.ldcolor;i.fire("init",{get:function(){return r.popup.data()},set:function(t,n){n==null&&(n={});r.popup.data(t);if(!n.passive){i.fire("event","change",t)}return f(r.popup.data())}});return d=new p({root:n,action:{click:{button:function(){return r.popup.get().then(function(t){i.fire("event","change",a(t));return f(t)})}}},text:{button:function(){var t;if(t=u.text){return t}else{return o("config")}}}})}};<\/script></div>'},{name:"@plotdb/konfig",version:"main",path:"quantity",code:'<div><script type="@plotdb/block">module.exports={pkg:{extend:{name:"@plotdb/konfig",version:"main",path:"base"},dependencies:[{name:"ldslider",version:"main",path:"index.min.css"},{name:"ldslider",version:"main",path:"index.min.js"}],i18n:{en:{unit:"Unit"},"zh-TW":{unit:"單位"}}},init:function(n){var t,e,i,u,r,a,o,l,f,d,s,c,m=this;t=n.root,e=n.context,i=n.data,u=n.pubsub;r=e.ldview,a=e.ldslider;o={};this._meta={};l=function(){return o.ldrs.get()+""+o.unit};f=function(n){var t;n==null&&(n={});t=l();if(!n.init&&t!==o.v){u.fire("event","change",t)}return o.v=t};d=function(n){var t,e;n==null&&(n={});t=import$({},n.unit);o.unit=t.name;if(t.from!=null){console.warn("[@plotdb/konfig] ctrl should use `default` for default value.\\nplease update your config to comply with it.")}if(t["default"]!=null){t.from=t["default"]}o.ldrs.setConfig((e=Object.fromEntries(["min","max","step","from","to","exp","limitMax","range","label"].map(function(n){return[n,t[n]]}).filter(function(n){return n[1]!=null})),e.unit=t.name||"",e));f({init:n.init});return c.render()};s=function(n){var t;n==null&&(n={});m._meta=t=JSON.parse(JSON.stringify(n.meta||{}));return d({unit:t.units[0],init:n.init})};u.fire("init",{get:function(){return l()},set:function(n,t){var e,i,r;t==null&&(t={});e=/^(\\d+(?:\\.(?:\\d+))?)(\\D*)/.exec(n+"");if(!e){e=/^(\\d+(?:\\.(?:\\d+))?)(\\D*)/.exec(this["default"]()+"")}if(!e){e=[0,0,this._meta.units[0]]}i=e[2]||o.unit||this._meta.units[0];r=+e[1]!==o.ldrs.get()&&i!==o.unit&&!t.passive;o.ldrs.set(+e[1]);o.unit=i;if(r){u.fire("event","change",l())}return c.render()},default:function(){return m._meta["default"]},meta:function(n){return s({meta:n})},render:function(){return o.ldrs.update()}});c=new r({root:t,initRender:false,action:{click:{switch:function(){return o.ldrs.edit()}}},init:{ldrs:function(n){var t;t=n.node;o.root=t;o.ldrs=new a({root:t});return o.ldrs.on("change",function(){return f()})}},text:{picked:function(){return o.unit}},handler:{unit:{list:function(){return m._meta.units},key:function(n){return n.name},action:{click:function(n){var t;t=n.data;return d({unit:t})}},text:function(n){var t;t=n.data;return t.name}}}});return c.init().then(function(){return s({meta:i,init:true})})}};function import$(n,t){var e={}.hasOwnProperty;for(var i in t)if(e.call(t,i))n[i]=t[i];return n}<\/script></div>'},{name:"@plotdb/konfig",version:"main",path:"text",code:'<div><script type="@plotdb/block">module.exports={pkg:{extend:{name:"@plotdb/konfig",version:"main",path:"base"},dependencies:[]},init:function(e){var n,t,u,a,r,i,o,v=this;n=e.root,t=e.context,u=e.data,a=e.pubsub;r=t.ldview;i=function(e){v._meta=JSON.parse(JSON.stringify(e));return v._values=v._meta.values||[]};i(u);a.fire("init",{get:function(){return o.get("input").value||""},set:function(e,n){var t;n==null&&(n={});t=o.get("input").value!==(e||"")&&!n.passive;e=o.get("input").value=e||"";if(t){return a.fire("event","change",e)}},default:function(){return v._meta["default"]||""},meta:function(e){return i(e)}});return o=new r({root:n,init:{input:function(e){var n;n=e.node;return n.value=u["default"]||""}},handler:{preset:{list:function(){return v._values||[]},key:function(e){return e.value||e.name||e},handler:function(e){var n,t;n=e.node,t=e.data;return n.textContent=t.name||t.value||t},action:{click:function(e){var n,t,u;n=e.node,t=e.data;o.get("input").value=u=t.value||t;return a.fire("event","change",u)}}}},action:{input:{input:function(e){var n;n=e.node;return a.fire("event","change",n.value)}},change:{input:function(e){var n;n=e.node;return a.fire("event","change",n.value)}}}})}};<\/script></div>'},{name:"@plotdb/konfig",version:"main",path:"upload",code:'<div><script type="@plotdb/block">var singleton;singleton={digest:{}};module.exports={pkg:{extend:{name:"@plotdb/konfig",version:"main",path:"base"},dependencies:[{name:"ldfile"}]},init:function(e){var t,n,i,u,r,l,s,o,a,f,d=this;t=e.root,n=e.context,i=e.data,u=e.pubsub;r=n.ldview,l=n.ldfile;s=i.dataSource||{};this._meta=i;o={files:[],digest:singleton.digest};a=function(e){return e.map(function(e){return{name:e.name,size:e.size,type:e.type,lastModified:e.lastModified,key:e.key,idx:e.idx,digest:e.digest}})};u.fire("init",{get:function(){return a(o.files)},set:function(e,t){t==null&&(t={});o.files=(Array.isArray(e)?e:[e]).map(function(e,t){var n,i,r;return i=(r=import$({},e),r.idx=t,r),i.blob=(n=o.digest[e.digest]||{}).blob,i.dataurl=n.dataurl,i});f.get("input").value="";if(!t.passive){return u.fire("event","change",a(o.files))}},default:function(){return[]},meta:function(e){return d._meta=e},object:function(){var t,e;t={changed:false};e=o.files.map(function(n,i){var e;if(n.blob){return Promise.resolve(n)}if(o.digest[n.digest]){return Promise.resolve((n.blob=(e=o.digest[n.digest]).blob,n.dataurl=e.dataurl,n))}if(n.result){n.dataurl=n.result;fetch(n.result).then(function(e){return e.blob()}).then(function(e){var t;n.name=n.name||"unnamed";t=(n.blob=e,n);t.size=e.size;t.type=e.type;t.lastModified=Date.now();delete n.result;if(s.digest==null){return n}else{return s.digest(n,i).then(function(e){return n.digest=e,n})}}).then(function(t){if(s.getKey==null){return t}else{return s.getKey(t,i).then(function(e){return t.key=e,t})}}).then(function(e){if(!e.digest){return e}else{return o.digest[e.digest]=e}}).then(function(){return t.changed=true})}if(n.key==null||s.getBlob==null){return Promise.resolve(n)}return s.getBlob(n,i).then(function(e){n.blob=e;return l.fromFile(e,"dataurl").then(function(e){n.dataurl=e.result;if(s.digest==null){return}return s.digest(n,i).then(function(e){if(n.digest!==e){t.changed=true}return n.digest=e})})})});return Promise.all(e).then(function(){if(t.changed){debounce(0).then(function(){return u.fire("event","change",a(o.files))})}return o.files})}});return f=new r({root:t,init:{input:function(e){var t;t=e.node;if(d._meta.multiple){return t.setAttribute("multiple",true)}}},action:{change:{input:function(e){var i,t,r;i=e.node;t=function(){var e,t,n=[];for(e=0,t=i.files.length;e<t;++e){r=e;n.push(i.files[r])}return n}().map(function(n,i){return l.fromFile(n,"dataurl").then(function(e){var t;return t={name:n.name,size:n.size,type:n.type,lastModified:n.lastModified},t.dataurl=e.result,t.blob=n,t.idx=i,t}).then(function(t){if(s.digest==null){return t}else{return s.digest(t,i).then(function(e){return t.digest=e,t})}}).then(function(t){if(s.getKey==null){return t}else{return s.getKey(t,i).then(function(e){return t.key=e,t})}}).then(function(e){if(!e.digest){return e}else{return o.digest[e.digest]=e}})});return Promise.all(t).then(function(e){o.files=e;i.value="";return u.fire("event","change",a(e))})}}}})}};function import$(e,t){var n={}.hasOwnProperty;for(var i in t)if(n.call(t,i))e[i]=t[i];return e}<\/script></div>'}])}();
